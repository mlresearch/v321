(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     23928,        603]
NotebookOptionsPosition[     22130,        566]
NotebookOutlinePosition[     22599,        584]
CellTagsIndexPosition[     22556,        581]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Define functions to calculate Laplacians and iterate trajectories\
\>", "Chapter",
 CellChangeTimes->{{3.968955108501204*^9, 3.968955125495323*^9}, {
  3.9689551864413357`*^9, 3.968955208980103*^9}, {3.968955287568377*^9, 
  3.968955289150648*^9}},ExpressionUUID->"496b99d8-591c-4ecd-868d-\
9d8d076f274f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"numbirds", "=", "15"}], ";", "\[IndentingNewLine]", 
   RowBox[{"P0", "=", 
    RowBox[{"N", "[", 
     RowBox[{"CirclePoints", "[", "numbirds", "]"}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.965869605588809*^9, 3.965869682532436*^9}, {
   3.9658700926406317`*^9, 3.965870095922245*^9}, {3.965870732434181*^9, 
   3.965870732902174*^9}, 3.9659953907425632`*^9},
 CellLabel->
  "In[152]:=",ExpressionUUID->"4020dc70-07c8-4e0c-8c82-4267c0251e6e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"G", "[", 
      RowBox[{"V_", ",", "\[Epsilon]_"}], "]"}], ":=", 
     RowBox[{"DirectedGraph", "[", 
      RowBox[{
       RowBox[{"NearestNeighborGraph", "[", 
        RowBox[{"V", ",", 
         RowBox[{"{", 
          RowBox[{"All", ",", "\[Epsilon]"}], "}"}]}], "]"}], ",", 
       "\"\<Random\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"G_", ",", "\[Sigma]_", ",", "\[Tau]_"}], "]"}], ":=", 
     RowBox[{"Switch", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"VertexList", "[", "G", "]"}], "[", 
        RowBox[{"[", "\[Tau]", "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"VertexList", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", "G", "]"}], "[", 
          RowBox[{"[", "\[Sigma]", "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"Normalize", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"VertexList", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "G", "]"}], "[", 
            RowBox[{"[", "\[Sigma]", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", 
         RowBox[{
          RowBox[{"VertexList", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "G", "]"}], "[", 
            RowBox[{"[", "\[Sigma]", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"VertexList", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", "G", "]"}], "[", 
          RowBox[{"[", "\[Sigma]", "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"Normalize", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"VertexList", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "G", "]"}], "[", 
            RowBox[{"[", "\[Sigma]", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", 
         RowBox[{
          RowBox[{"VertexList", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "G", "]"}], "[", 
            RowBox[{"[", "\[Sigma]", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]",
        "_", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9658663510947847`*^9, 3.965866415907345*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"2ab5df51-9e6f-42ab-8585-c650fc815c47"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[CapitalDelta]", "[", "G_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[Delta]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Delta]", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"G", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"EdgeCount", "[", "G", "]"}], ",", "numbirds"}], "}"}]}],
           "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Delta]", ".", 
       RowBox[{"Transpose", "[", "\[Delta]", "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.965866432937294*^9, 3.9658664791881657`*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"e3d5e7f1-f59b-4b6d-b2ea-72fdb72f89a8"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Traj", "[", 
     RowBox[{
     "P0_", ",", "V0_", ",", "dt_", ",", "\[Epsilon]_", ",", "n_", ",", 
      "\[Alpha]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"P", "=", "P0"}], ",", 
        RowBox[{"V", "=", "V0"}], ",", "Pnew", ",", "Vnew", ",", "ps", ",", 
        "vs"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ps", " ", "=", " ", 
        RowBox[{"{", "P", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vs", "=", 
        RowBox[{"{", "V", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", "n"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Vnew", " ", "=", " ", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Flatten", "[", "V", "]"}], "-", 
              RowBox[{"dt", "*", "\[Alpha]", "*", " ", 
               RowBox[{
                RowBox[{"\[CapitalDelta]", "[", 
                 RowBox[{"G", "[", 
                  RowBox[{"P", ",", "\[Epsilon]"}], "]"}], "]"}], ".", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"Flatten", "[", "V", "]"}], "]"}]}]}]}], ",", "2"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Pnew", " ", "=", " ", 
           RowBox[{"P", "+", 
            RowBox[{"dt", "*", "V"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"ps", ",", "Pnew"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"vs", ",", "Vnew"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"P", "=", "Pnew"}], ";", "\[IndentingNewLine]", 
          RowBox[{"V", "=", "Vnew"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ps", ",", "vs"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TrajMod", "[", 
     RowBox[{
     "P0_", ",", "V0_", ",", "dt_", ",", "\[Epsilon]_", ",", "n_", ",", 
      "\[Alpha]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"P", "=", "P0"}], ",", 
        RowBox[{"V", "=", "V0"}], ",", "Pnew", ",", "Vnew", ",", "ps", ",", 
        "vs"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ps", " ", "=", " ", 
        RowBox[{"{", "P", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vs", "=", 
        RowBox[{"{", "V", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", "n"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Vnew", " ", "=", " ", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Flatten", "[", "V", "]"}], "-", 
              RowBox[{"dt", "*", "\[Alpha]", "*", " ", 
               RowBox[{
                RowBox[{"\[CapitalDelta]", "[", 
                 RowBox[{"G", "[", 
                  RowBox[{"P", ",", "\[Epsilon]"}], "]"}], "]"}], ".", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"Flatten", "[", "V", "]"}], "]"}]}]}]}], ",", "2"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Pnew", " ", "=", " ", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"P", "+", 
              RowBox[{"dt", "*", "V"}]}], ",", "1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"ps", ",", "Pnew"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"vs", ",", "Vnew"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"P", "=", "Pnew"}], ";", "\[IndentingNewLine]", 
          RowBox[{"V", "=", "Vnew"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ps", ",", "vs"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.965867821725801*^9, 3.9658680613159933`*^9}, {
  3.9658682029352818`*^9, 3.965868333686799*^9}, {3.965871714353595*^9, 
  3.965871715345055*^9}, {3.96587175794814*^9, 3.965871800551453*^9}, {
  3.967911509075213*^9, 3.967911562461761*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"a6533d90-ab83-4050-9b2e-ed912c38ec1f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Generate random birds - initial positions and velocities, and set parameters\
\>", "Chapter",
 CellChangeTimes->{{3.968955108501204*^9, 3.968955125495323*^9}, {
  3.968955162513082*^9, 
  3.9689551836149273`*^9}},ExpressionUUID->"023772e5-d5d8-424c-ada9-\
197b0ed044bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"numbirds", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P0", " ", "=", " ", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"numbirds", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"P0", "=", 
     RowBox[{"Catenate", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"numbirds", ",", "2"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"1", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"numbirds", ",", "2"}], "}"}]}], "]"}]}], "}"}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"numbirds", "=", 
     RowBox[{"2", "*", "numbirds"}]}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.965866330431817*^9, 3.965866366794683*^9}, {
   3.965866618912682*^9, 3.965866622579423*^9}, {3.96586927786338*^9, 
   3.965869278541939*^9}, {3.965871829806279*^9, 3.9658718344501047`*^9}, {
   3.965871927034546*^9, 3.9658719271117287`*^9}, {3.968487358893219*^9, 
   3.9684873589771748`*^9}, 3.968955128928932*^9},
 CellLabel->
  "In[158]:=",ExpressionUUID->"0075126b-c4e4-470e-8a0f-f1d663a28cb2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"V0", " ", "=", " ", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"numbirds", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"V0", " ", "=", " ", 
     RowBox[{"N", "[", 
      RowBox[{"CirclePoints", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "numbirds"}], "]"}], 
      "]"}]}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9658683515330057`*^9, 3.96586838544849*^9}, {
   3.965868420575265*^9, 3.965868438490497*^9}, {3.965868490088319*^9, 
   3.9658685478730793`*^9}, {3.9658687265773*^9, 3.965868766960022*^9}, {
   3.9658688322272673`*^9, 3.96586887307075*^9}, {3.9658689799331617`*^9, 
   3.965868979993539*^9}, {3.965869043614071*^9, 3.965869043687669*^9}, {
   3.965869080031423*^9, 3.9658690801081*^9}, {3.9658693065475407`*^9, 
   3.9658693073818283`*^9}, {3.965869386173633*^9, 3.965869386488852*^9}, {
   3.965869530829095*^9, 3.965869530963983*^9}, {3.96586969841823*^9, 
   3.965869834278723*^9}, 3.965869911048107*^9, 3.965870149962267*^9, {
   3.9658702369454603`*^9, 3.965870239131504*^9}, {3.965870310180416*^9, 
   3.9658703318491907`*^9}, {3.9658704269049673`*^9, 3.965870474655648*^9}, {
   3.965870525506453*^9, 3.965870563585433*^9}, {3.965870640757538*^9, 
   3.965870702881475*^9}, {3.9658707857257223`*^9, 3.965870785872558*^9}, {
   3.965870881374688*^9, 3.965870891911201*^9}, {3.965870938357862*^9, 
   3.965870939207584*^9}, {3.965870988041685*^9, 3.96587100561875*^9}, {
   3.965871188431493*^9, 3.96587119795255*^9}, {3.965871231322378*^9, 
   3.96587123291439*^9}, {3.965871313533469*^9, 3.965871340184326*^9}, {
   3.965872027037141*^9, 3.965872027105214*^9}, {3.966077142998028*^9, 
   3.966077143031376*^9}, 3.967911588985796*^9, 3.9679842443449707`*^9, {
   3.9684873420091047`*^9, 3.9684873425226727`*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"389cd73d-95b1-4999-8ba6-b919cb6473e7"],

Cell[BoxData[{
 RowBox[{"\[Alpha]", "=", "0.5"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nsteps", " ", "=", " ", "2400"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dt", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]", "=", "0.6"}], ";"}]}], "Input",
 CellChangeTimes->{{3.968955222225211*^9, 3.968955224582939*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"094f2a8a-1cbf-42dd-bc80-1069aaf293fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run Simulation ", "Chapter",
 CellChangeTimes->{{3.968955108501204*^9, 3.968955125495323*^9}, {
  3.968955162513082*^9, 3.9689551836149273`*^9}, {3.968955237593915*^9, 
  3.968955241522142*^9}},ExpressionUUID->"eafaf3ad-35ab-4520-acd6-\
13e82389bbd6"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"data", " ", "=", " ", 
     RowBox[{"Traj", "[", 
      RowBox[{
      "P0", ",", "V0", ",", "dt", ",", "\[Epsilon]", ",", "nsteps", ",", 
       "\[Alpha]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ps", " ", "=", " ", 
     RowBox[{"data", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vs", "=", 
     RowBox[{"data", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.965869745091196*^9, 3.9658697457930307`*^9}, {
   3.965870154838538*^9, 3.965870155420453*^9}, {3.965871854206949*^9, 
   3.965871854639296*^9}, {3.9659956238437634`*^9, 3.965995624322319*^9}, {
   3.967911566183812*^9, 3.9679115677848587`*^9}, {3.967911640691827*^9, 
   3.967911654178295*^9}, {3.967911800565906*^9, 3.9679118009277897`*^9}, 
   3.9679118695463667`*^9, {3.967984234220263*^9, 3.967984234724544*^9}, {
   3.967984362853052*^9, 3.967984364287438*^9}, {3.968141340406597*^9, 
   3.968141340796981*^9}, {3.968487318385726*^9, 3.968487367348592*^9}, {
   3.968487414271887*^9, 3.968487415586639*^9}, {3.968488948168898*^9, 
   3.968488949142639*^9}, {3.968489096154437*^9, 3.968489097392952*^9}, {
   3.9684964297979527`*^9, 3.968496430356257*^9}, {3.968496762625388*^9, 
   3.96849676294942*^9}, {3.968496850890559*^9, 3.9684968553009167`*^9}, 
   3.9684969659447613`*^9, {3.968497265590124*^9, 3.968497268398931*^9}, 
   3.968955221067775*^9},
 CellLabel->
  "In[165]:=",ExpressionUUID->"72bf4602-5e76-45fe-a28d-c3c6e1178be7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualize Results", "Chapter",
 CellChangeTimes->{{3.968955108501204*^9, 3.968955125495323*^9}, {
  3.968955162513082*^9, 3.9689551836149273`*^9}, {3.968955247306137*^9, 
  3.9689552493726463`*^9}},ExpressionUUID->"0d04da14-80c0-4788-9226-\
1c252d03a25b"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{"showgraph", ",", 
       RowBox[{"G", "[", 
        RowBox[{
         RowBox[{"ps", "[", 
          RowBox[{"[", "n", "]"}], "]"}], ",", "\[Epsilon]"}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{"#2", ",", "#1"}], "}"}], "]"}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"dt", "*", 
           RowBox[{"vs", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "+", 
          RowBox[{"ps", "[", 
           RowBox[{"[", "n", "]"}], "]"}]}], ",", 
         RowBox[{"ps", "[", 
          RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"ps", "[", 
       RowBox[{"[", "n", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ","}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Axes", "->", "False"}], ",", "\[IndentingNewLine]", 
     RowBox[{"AspectRatio", "->", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "nsteps", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"showgraph", ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "\[IndentingNewLine]",
   "]"}]], "Input",
 CellChangeTimes->{{3.965868552498086*^9, 3.965868681354795*^9}, {
   3.965868772933476*^9, 3.965868774393051*^9}, 3.965868922600587*^9, 
   3.965868952618376*^9, 3.965871273779827*^9, 3.965871402226396*^9, 
   3.965871554130625*^9, {3.965871906622581*^9, 3.965871909593472*^9}, 
   3.965871952869975*^9, 3.965872000354601*^9, 3.965872070851254*^9, 
   3.966010819271309*^9, 3.966077055111347*^9, {3.966340898120944*^9, 
   3.966340912119915*^9}, {3.966340986666752*^9, 3.966341038093889*^9}, {
   3.9684900382041607`*^9, 3.9684900660531387`*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"172c6f75-aec8-4fd5-a937-32a86b11f367"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListLinePlot", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"ps", "[", 
           RowBox[{"[", 
            RowBox[{";;", "n"}], "]"}], "]"}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"showgraph", ",", 
          RowBox[{"G", "[", 
           RowBox[{
            RowBox[{"ps", "[", 
             RowBox[{"[", "n", "]"}], "]"}], ",", "\[Epsilon]"}], "]"}], ",", 
          
          RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"#2", ",", "#1"}], "}"}], "]"}]}], "}"}], "]"}], 
           "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"dt", "*", 
              RowBox[{"vs", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "+", 
             RowBox[{"ps", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], ",", 
            RowBox[{"ps", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"ps", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"PointSize", "[", "Large", "]"}]}], "}"}]}]}], "]"}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Axes", "->", "False"}], ",", 
      RowBox[{"AspectRatio", "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", "nsteps", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"showgraph", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.966076928415584*^9, 3.9660769827400093`*^9}, {
  3.968487095466031*^9, 3.968487129631506*^9}, {3.968487211150322*^9, 
  3.968487228391336*^9}, {3.968487294199368*^9, 3.968487295930189*^9}, {
  3.968488918891309*^9, 3.968488920755868*^9}, {3.96849490862284*^9, 
  3.9684949266121893`*^9}, {3.968495044438446*^9, 3.968495122483354*^9}, {
  3.968495188338127*^9, 3.968495237255724*^9}, {3.968495287457219*^9, 
  3.968495307318532*^9}, {3.968495358069751*^9, 3.968495378227029*^9}, {
  3.968497318872253*^9, 3.968497407119239*^9}, {3.9689552608158817`*^9, 
  3.968955261602635*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"f2e996f7-9166-48db-81ce-988f9edf38e2"]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{316, Automatic}, {Automatic, 50}},
TaggingRules->Association["TryRealOnly" -> False],
CellContext->Notebook,
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"aa387066-ae73-4d4d-a642-35472739dd87"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 315, 6, 69, "Chapter",ExpressionUUID->"496b99d8-591c-4ecd-868d-9d8d076f274f"],
Cell[898, 30, 516, 12, 52, "Input",ExpressionUUID->"4020dc70-07c8-4e0c-8c82-4267c0251e6e"],
Cell[1417, 44, 2643, 69, 157, "Input",ExpressionUUID->"2ab5df51-9e6f-42ab-8585-c650fc815c47"],
Cell[4063, 115, 1036, 28, 115, "Input",ExpressionUUID->"e3d5e7f1-f59b-4b6d-b2ea-72fdb72f89a8"],
Cell[5102, 145, 4655, 109, 598, "Input",ExpressionUUID->"a6533d90-ab83-4050-9b2e-ed912c38ec1f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9794, 259, 280, 6, 69, "Chapter",ExpressionUUID->"023772e5-d5d8-424c-ada9-197b0ed044bd"],
Cell[10077, 267, 1660, 44, 157, "Input",ExpressionUUID->"0075126b-c4e4-470e-8a0f-f1d663a28cb2"],
Cell[11740, 313, 2194, 45, 52, "Input",ExpressionUUID->"389cd73d-95b1-4999-8ba6-b919cb6473e7"],
Cell[13937, 360, 446, 10, 94, "Input",ExpressionUUID->"094f2a8a-1cbf-42dd-bc80-1069aaf293fc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14420, 375, 257, 4, 69, "Chapter",ExpressionUUID->"eafaf3ad-35ab-4520-acd6-13e82389bbd6"],
Cell[14680, 381, 1614, 32, 94, "Input",ExpressionUUID->"72bf4602-5e76-45fe-a28d-c3c6e1178be7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16331, 418, 261, 4, 69, "Chapter",ExpressionUUID->"0d04da14-80c0-4788-9226-1c252d03a25b"],
Cell[16595, 424, 2531, 64, 220, "Input",ExpressionUUID->"172c6f75-aec8-4fd5-a937-32a86b11f367"],
Cell[19129, 490, 2985, 73, 199, "Input",ExpressionUUID->"f2e996f7-9166-48db-81ce-988f9edf38e2"]
}, Open  ]]
}
]
*)

